[
    {"server_command": ["@SERVER@", "--http",
                 "--x509keyfile", "tests/serverX509Key.pem",
                 "--x509certfile", "tests/serverX509Cert.pem",
                 "--debug=6",
                 "--priority=@PRIORITY@",
                 "--port=@PORT@"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
	 {"name" : "test-tls13-certificate-verify.py",
          "comment" : "tlsfuzzer does not expect ML-DSA",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-s", "mldsa44 mldsa65 mldsa87 rsa_pkcs1_sha256 rsa_pss_pss_sha256 rsa_pss_rsae_sha256 ecdsa_secp256r1_sha256 ed25519 rsa_pkcs1_sha384 rsa_pss_pss_sha384 rsa_pss_rsae_sha384 ecdsa_secp384r1_sha384 ed448 rsa_pkcs1_sha512 rsa_pss_pss_sha512 rsa_pss_rsae_sha512 ecdsa_secp521r1_sha512 rsa_pkcs1_sha1 ecdsa_sha1",
	                 "-p", "@PORT@"]},
	 {"name" : "test-tls13-ecdsa-in-certificate-verify.py",
          "comment" : "tlsfuzzer does not expect ML-DSA",
          "arguments" : ["-k", "tests/serverECKey.pem",
                         "-c", "tests/serverECCert.pem",
                         "-s", "mldsa44 mldsa65 mldsa87 rsa_pkcs1_sha256 rsa_pss_pss_sha256 rsa_pss_rsae_sha256 ecdsa_secp256r1_sha256 ed25519 rsa_pkcs1_sha384 rsa_pss_pss_sha384 rsa_pss_rsae_sha384 ecdsa_secp384r1_sha384 ed448 rsa_pkcs1_sha512 rsa_pss_pss_sha512 rsa_pss_rsae_sha512 ecdsa_secp521r1_sha512 rsa_pkcs1_sha1 ecdsa_sha1",
	                 "-p", "@PORT@"]},
         {"name": "test-rsa-sigs-on-certificate-verify.py",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-p", "@PORT@"]
         },
         {"name" : "test-certificate-verify.py",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-p", "@PORT@"]
          },
         {"name" : "test-ecdsa-in-certificate-verify.py",
          "comment" : "we don't support sha224 and brainpool; we send handshake_failure instead of illegal_parameter in md5+ecdsa",
          "arguments" : ["-k", "tests/serverECKey.pem",
                         "-c", "tests/serverECCert.pem",
                         "-e", "make sha224+ecdsa signature in CertificateVerify",
                         "-e", "make sha224+ecdsa signature, advertise it as sha1+ecdsa in CertificateVerify",
                         "-e", "make sha224+ecdsa signature, advertise it as sha256+ecdsa in CertificateVerify",
                         "-e", "make sha224+ecdsa signature, advertise it as sha384+ecdsa in CertificateVerify",
                         "-e", "make sha224+ecdsa signature, advertise it as sha512+ecdsa in CertificateVerify",
                         "-e", "make ecdsa_secp256r1_sha256 signature, advertise it as ecdsa_brainpoolP256r1tls13_sha256 in CertificateVerify",
                         "-e", "make ecdsa_secp384r1_sha384 signature, advertise it as ecdsa_brainpoolP384r1tls13_sha384 in CertificateVerify",
                         "-e", "make ecdsa_secp521r1_sha512 signature, advertise it as ecdsa_brainpoolP512r1tls13_sha512 in CertificateVerify",
                         "-e", "md5+ecdsa forced",
                         "-e", "make sha1+ecdsa signature, advertise it as sha224+ecdsa in CertificateVerify",
                         "-e", "make sha256+ecdsa signature, advertise it as sha224+ecdsa in CertificateVerify",
                         "-e", "make sha384+ecdsa signature, advertise it as sha224+ecdsa in CertificateVerify",
                         "-e", "make sha512+ecdsa signature, advertise it as sha224+ecdsa in CertificateVerify",
                         "-p", "@PORT@"]
          },
         {"name" : "test-certificate-verify-malformed.py",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-p", "@PORT@"]
          },
         {"name" : "test-certificate-verify-malformed-sig.py",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-p", "@PORT@"]
          },
         {"name" : "test-certificate-request.py",
          "comment" : "tlsfuzzer doesn't like our set of algorithms or supported cert types",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-e", "check sigalgs in cert request",
                         "-e", "check cert types in cert request",
                         "-p", "@PORT@"]
          },
         {"name" : "test-rsa-pss-sigs-on-certificate-verify.py",
	  "comment": "tlsfuzzer doesn't know ed25519 scheme which we advertise",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-e", "check CertificateRequest sigalgs",
                         "--illegpar",
                         "-p", "@PORT@"]
          },
         {"name" : "test-rsa-pss-sigs-on-certificate-verify.py",
	  "comment": "tlsfuzzer doesn't know ed25519 scheme which we advertise",
          "arguments" : ["-k", "tests/clientRSAPSSKey.pem",
                         "-c", "tests/clientRSAPSSCert.pem",
                         "-e", "check CertificateRequest sigalgs",
                         "--illegpar",
                         "-p", "@PORT@"]
          },
         {"name": "test-certificate-malformed.py",
          "comment" : "tlsfuzzer doesn't like the alerts we send",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-e", "fuzz empty certificate - overall 7, certs 4, cert 1",
                         "-e", "fuzz empty certificate - overall 8, certs 5, cert 2",
                         "-e", "sanity - empty client cert",
                         "-e", "Correct cert followed by an empty one",
                         "-p", "@PORT@"]
	 }
     ]
    },
    {"server_command": ["@SERVER@", "--http",
                 "--x509keyfile", "tests/serverX509Key.pem",
                 "--x509certfile", "tests/serverX509Cert.pem",
                 "--debug=6",
                 "--priority=NORMAL:+VERS-TLS1.2",
                 "--port=@PORT@"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
         {"name" : "test-certificate-request.py",
          "arguments" : ["-k", "tests/clientX509Key.pem",
                         "-c", "tests/clientX509Cert.pem",
                         "-p", "@PORT@",
                         "-s", "sha256+rsa rsa_pss_pss_sha256 rsa_pss_rsae_sha256 sha256+ecdsa rsa_pss_rsae_sha256 sha384+rsa rsa_pss_pss_sha384 rsa_pss_rsae_sha384 sha384+ecdsa ed448 sha512+rsa rsa_pss_pss_sha512 rsa_pss_rsae_sha512 sha512+ecdsa sha1+rsa sha1+ecdsa",
                         "check cert types in cert request"]
         }
     ]
    }
]
