[
    {"server_command": ["@SERVER@", "--http",
                 "--x509keyfile", "tests/serverX509Key.pem",
                 "--x509certfile", "tests/serverX509Cert.pem",
                 "--x509keyfile", "tests/serverRSAPSSKey.pem",
                 "--x509certfile", "tests/serverRSAPSSCert.pem",
                 "--x509keyfile", "tests/serverECKey.pem",
                 "--x509certfile", "tests/serverECCert.pem",
                 "--x509keyfile", "tests/serverP384ECKey.pem",
                 "--x509certfile", "tests/serverP384ECCert.pem",
                 "--x509keyfile", "tests/serverP521ECKey.pem",
                 "--x509certfile", "tests/serverP521ECCert.pem",
                 "--debug=6",
                 "--httpdata=../http.dat",
                 "--priority=@PRIORITY@",
                 "--disable-client-cert", "--port=@PORT@"],
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
         {"name" : "test-record-size-limit.py",
          "comment" : "changed extension after HRR is not supported #617",
          "arguments" : ["-p", "@PORT@", "--reply-AD-size", "1024",
			"--minimal-size", "512",
			"-e", "change size in TLS 1.2 resumption",
			"-e", "check if server accepts maximum size in TLS 1.0",
			"-e", "check if server accepts maximum size in TLS 1.1",
			"-e", "check if server accepts maximum size in TLS 1.2",
			"-e", "check if server accepts minimal size in TLS 1.0",
			"-e", "check if server accepts minimal size in TLS 1.1",
			"-e", "check if server accepts minimal size in TLS 1.2",
			"-x", "check interaction with sha256 prf",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-e", "check server sent size in TLS 1.0",
			"-e", "check server sent size in TLS 1.1",
			"-e", "check server sent size in TLS 1.2",
			"-e", "drop extension in TLS 1.2 resumption",
			"-x", "modified extension in 2nd CH in HRR handshake",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-e", "renegotiation with dropped extension",
			"-x", "added extension in 2nd CH in HRR handshake",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-e", "check server sent size in TLS 1.0 with max_fragment_length",
			"-e", "check server sent size in TLS 1.1 with max_fragment_length",
			"-e", "check server sent size in TLS 1.2 with max_fragment_length",
			"-x", "removed extension in 2nd CH in HRR handshake",
			"-X", "Unexpected message from peer: Handshake(server_hello)"] },
	 {"name" : "test-tls13-0rtt-garbage.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-ccs.py",
	  "comment" : "malformed CCS in TLS 1.3 is discarded without an alert (#1788)",
	  "arguments": ["-p", "@PORT@",
			"-e", "two byte long CCS"]},
	 {"name" : "test-tls13-crfg-curves.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-connection-abort.py",
	  "arguments": ["-p", "@PORT@", "--repeat", "3"]},
	 {"name" : "test-tls13-no-unknown-groups.py",
	  "arguments": ["-p", "@PORT@",
			"--groups", "secp256r1,secp384r1,secp521r1,x25519,x448,ffdhe2048,ffdhe3072,ffdhe4096,ffdhe6144,ffdhe8192,x25519mlkem768,secp256r1mlkem768,secp384r1mlkem1024"]},
	 {"name" : "test-tls13-unencrypted-alert.py",
	  "comment": "automatic early start sends NST early, RFC8446.4.6.1-legal",
	  "arguments": ["-p", "@PORT@",
			"-x", "unencrypted Alert",
			"-X", "Unexpected message from peer: Handshake(new_session_ticket)",
			"-x", "encrypted Alert",
			"-X", "Unexpected message from peer: Handshake(new_session_ticket)"]},
	 {"name" : "test-tls13-conversation.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-count-tickets.py",
	  "arguments": ["-p", "@PORT@", "-t", "2"]},
	 {"name" : "test-tls13-dhe-shared-secret-padding.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-ecdhe-curves.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-ecdsa-support.py",
	  "comment": "we don't support brainpool",
	  "arguments": ["-p", "@PORT@",
			"-x", "Test with ecdsa_brainpoolP256r1tls13_sha256",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "Test with ecdsa_brainpoolP384r1tls13_sha384",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "Test with ecdsa_brainpoolP512r1tls13_sha512",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)"]},
	 {"name" : "test-tls13-empty-alert.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-ffdhe-groups.py",
	  "comment" : "We do not check for duplicate entries",
	  "arguments": ["-p", "@PORT@",
			"-x", "ffdhe2048 - duplicated key share entry",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-x", "ffdhe3072 - duplicated key share entry",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-x", "ffdhe4096 - duplicated key share entry",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-x", "ffdhe6144 - duplicated key share entry",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-x", "ffdhe8192 - duplicated key share entry",
			"-X", "Unexpected message from peer: Handshake(server_hello)",
			"-t", "180"]},
	 {"name" : "test-tls13-ffdhe-sanity.py",
	  "arguments": ["-p", "@PORT@",
			"-t", "180"]},
	 {"name" : "test-tls13-finished.py",
	  "comment" : "ALL padding tests are racing against GnuTLS early NST optimization (RFC8446.4.6.1-legal); extreme padding ones also timeout time-to-time due to tlsfuzzer being slow without m2crypto",
	  "arguments": ["-p", "@PORT@",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 1",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 2",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 4",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 8",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 16",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 32",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 48",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 16348",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 131072",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 196608",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 0, pad_right 16777183",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 1, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 2, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 4, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 8, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 16, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 32, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 48, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 16348, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 12, pad_right 0",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 1, pad_right 1",
			"-e", "padding - cipher TLS_AES_128_GCM_SHA256, pad_byte 0, pad_left 8, pad_right 8",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 1",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 2",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 4",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 8",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 16",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 32",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 48",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 16332",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 131072",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 196608",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 16777167",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 0, pad_right 12",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 1, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 2, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 4, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 8, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 16, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 32, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 48, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 16332, pad_right 0",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 1, pad_right 1",
			"-e", "padding - cipher TLS_AES_256_GCM_SHA384, pad_byte 0, pad_left 8, pad_right 8"]},
	 {"name" : "test-tls13-hrr.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-invalid-ciphers.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-keyshare-omitted.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-keyupdate.py",
	  "comment" : "we have limits that prohibit the running multiple messages test; app data split timeouts waiting for new session ticket; #1789",
	  "arguments": ["-p", "@PORT@",
			"-e", "app data split, conversation with KeyUpdate msg",
			"-e", "multiple KeyUpdate messages",
			"-x", "two KeyUpdates in one record",
			"-X", "Expected alert description \"unexpected_message\" does not match received \"bad_record_mac\""]},
	 {"name" : "test-tls13-large-number-of-extensions.py",
	  "comment" : "This test assumes that 22 (EtM) is unassigned which is incorrect - see #632",
	  "arguments": ["-p", "@PORT@",
			"--exc", "11",
			"--exc", "12",
			"--exc", "22",
			"--exc", "23"]},
	 {"name" : "test-tls13-legacy-version.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-nociphers.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-non-support.py",
	  "arguments": ["-p", "@PORT@"],
	  "exp_pass" : false},
	 {"name" : "test-tls13-pkcs-signature.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-record-padding.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-rsapss-signatures.py",
	  "arguments": ["-p", "@PORT@", "-b"]},
	 {"name" : "test-tls13-rsa-signatures.py",
	  "arguments": ["-p", "@PORT@", "-b"]},
	 {"name" : "test-tls13-session-resumption.py",
	  "comment": "PSK_ONLY doesn't send new session ticket; get_server_public_key() returns first (1.2 RSA) cert, not last (1.3 RSA-PSS)",
	  "arguments": ["-p", "@PORT@",
			"-e", "session resumption - PSK_ONLY",
			"-e", "use TLS 1.2 ticket in TLS 1.3"]},
	 {"name" : "test-tls13-serverhello-random.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-signature-algorithms.py",
          "comment" : "gnutls doesn't handle well duplicated signature algorithms; this is not an issue in practice",
	  "arguments": ["-p", "@PORT@",
			"-x", "213 invalid schemes",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "2353 invalid schemes",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "8130 invalid schemes",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "23752 invalid schemes",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)",
			"-x", "32715 invalid schemes",
			"-X", "Unexpected message from peer: Alert(fatal, handshake_failure)"]},
	 {"name" : "test-tls13-symetric-ciphers.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-unrecognised-groups.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-version-negotiation.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-tls13-zero-length-data.py",
	  "arguments": ["-p", "@PORT@"]},
	 {"name" : "test-downgrade-protection.py",
	  "comment" : "1/n-1 splitting in TLS 1.0 is not supported",
	  "arguments": ["-p", "@PORT@", "--server-max-protocol", "TLSv1.3",
			"-x", "TLS 1.3 downgrade check for Protocol (3, 1)",
			"-X", "Unexpected message from peer: Alert(fatal, protocol_version)"]}
     ]
    }
]
